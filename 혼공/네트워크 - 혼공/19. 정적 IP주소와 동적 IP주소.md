### 정적 할당
- 호스트에 직접(수작업으로) IP 주소를 부여하는 방식
- 이렇게 할당된 IP 주소 = 정적 IP 주소(static IP address)
- 기관이나 회사가 ISP로부터 부여받은 네트워크 대역 내에서 관리자가 특정 장비(PC, 라우터 등)에 지정한 IP 주소를 말함

##### 정적 IP 주소 부여
- 윈도우나 MAC OS 등의 네트워크 설정에서 다음 화면처럼 IP 주소를 수동으로 설정
- 일반적으로 부여하고자 하는 **IP주소, 서브넷 마스크, 게이트웨이(라우터) 주소, DNS** 주소를 입력

![](../../README_resources/Pasted%20image%2020251006191833.png)

##### 기본 게이트웨이
- 게이트웨이(gateway)의 일반적인 의미
	- 서로 다른 네트워크를 연결하는 하드웨어적/소프트웨어적 수단
- 기본 게이트웨이(default gateway)
	- 호스트가 속한 네트워크 외부로 나가기 위한 기본적인 첫 경로에 위치한 노드
	- 네트워크 외부와 연결된 라우터(공유기)의 주소를 의미하는 경우가 많음
	- IP 할당의 맥락에서 사용된 `게이트웨이` 라는 용어는 **기본 게이트웨이(라우터(공유기)의 주소)** 를 의미함

##### 모든 IP 주소를 정적으로 할당할 수 있을까
- 호스트 수가 많아질 경우엔 관리가 어려움
	-> 의도치 않게 잘못된 IP 주소를 입력할 수도 있고, 중복된 IP 주소를 입력할 수도 있기 때문

### 동적 할당
- 호스트에게 IP 주소를 프로토콜을 활용해 자동으로 할당하는 방식
	- IP 동적 할당에 사용되는 대표적인 프로토콜 **DHCP(Dynaminc Host Configuration Protocol)**
	-  이렇게 할당된 IP 주소를 동적 IP 주소라고 함(dynamic IP address) 라고 함

##### DHCP를 통한 IP 주소 할당
- 클라이언트와 DHCP 서버 간 메시지 송수신을 통해 할당이 이루어짐
- 클라이언트 : IP 주소를 할당받고자 하는 호스트
- DHCP 서버 : 호스트에게 IP 주소를 제공하는 호스트
	- DHCP 서버의 역할은 일반적으로 라우터(공유기)가 수행함
	- 특정 호스트에 DHCP 서버 기능을 추가할 수도 있음
	- DHCP 서버는 클라이언트에게 할당 가능한 IP 주소 목록을 관리하다가 클라이언트가 IP를 요청하면 해당 클라이언트에게 IP 주소를 할당함
- DHCP 로부터 할당받은 동적 IP 주소는 사용할 기간(임대 기간)이 정해짐
	- 일반적으로 수 시간에서 수 일
	- 임대 기간이 끝난 IP 주소는 다시 DHCP 서버로 반납하게 됨
	- IP 주소를 반납 후에 다시 받을 경우에는 처음에 받았던 IP 주소와는 다른 IP 주소를 받을 수도 있는 것

![](../../README_resources/Pasted%20image%2020251006193436.png)

##### IP 주소 할당 과정에서 주고 받는 메시지
1. DHCP Discover (클라이언트 -> DHCP 서버)
	- DHCP 서버를 찾는 메시지
	- 브로드캐스트로 전송
	- 클라이언트는 아직 IP 주소를 할당받지 못한 상태임(송신지 IP 주소는 0.0.0.0으로 설정)
2. DHCP Offer (DHCP 서버 -> 클라이언트)
	- 클라이언트에게 할당 가능한 IP 주소 정보를 제안하는 메시지
	- 할당 가능한 IP 주소, 서브넷 마스크, 임대 기간 등의 정보를 포함함
	- 브로드캐스트로 전송(IP주소를 받게 될 호스트가 아직 IP주소를 사용할 수 없는 상태라고 보기 때문에 브로드캐스트로 전송)
3. DHCP Request (클라이언트 -> DHCP 서버)
	- DHCP Offer 메시지에 대한 응답
	- 브로드캐스트로 전송 (DHCP 서버가 여러 개인 경우 선택되지 못한 Offer를 보낸 서버들도 인식할 수 있도록 브로드캐스트로 전송)
4. DHCP Acknowledgment(이하 DHCP ACK)
	- 최종 승인과 같은 메시지
	- DHCP ACK 메시지를 클라이언트는 이제 할당받은 IP 주소를 자신의 IP 주소로 설정 후 임대 기간 동안 IP 주소로 사용함
	- 브로드캐스트로 전송(IP주소를 받게 될 호스트가 아직 IP주소를 사용할 수 없는 상태라고 보기 때문에 브로드캐스트로 전송)

**임대 기간이 끝나면??**
- IP 주소는 DHCP 서버에 반납
- 원칙적으로는 다시 DHCP Discover - DHCP Offer - DHCP Request - DHCP ACK 순으로 주고받아 IP 주소를 재할당받음.
- 임대 갱신 (lease renewal)
	- IP 주소 임대 기간이 끝나기 전에 임대 기간을 연장하는 것
	- 임대 기간이 끝나기 전에 기본적으로 두 차례 자동으로 수행
	- 자동 임대 갱신이 모두 실패하면 그때 IP 주소 반납 (이후 재할당)`

![](../../README_resources/Pasted%20image%2020251006193707.png)

