- 특정 호스트와 통신을 하기 위해서는 MAC주소와 IP주소를 다 알아야 함(이유 : https://aws-hyoh.tistory.com/70 참고)
- 그런데 IP주소 정보만 아는 상황이라면 어떻게 해야 할까?? => ARP 라는 프로토콜을 통해 알아냄

### ARP(Address Resolution Protocol)
- IP 주소를 통해 MAC 주소를 알아내는 프로토콜
	- 동일 네트워크 내에 있는 송수신 대상의 IP 주소를 통해 MAC 주소를 알아낼 수 있음
	- ARP 동작
	1. ARP 요청
	2. ARP 응답
	3. ARP 테이블 갱신

0035

### 가정
- 동일 네틑워크에 속한 A, B가 있음
- 호스트 A는 호스트 B의 IP 주소는 알지만 MAC 주소는 모르는 상황
- 이 때 호스트 B의 MAC 주소를 알아내는 과정

1. ARP 요청
- 호스트 A가 **브로드캐스트 메시지**를 전송함(이 메시지에 통신하고자 하는 IP주소가 포함되어 있음)
- 이 브로드캐스트 메시지는 ARP요청이라는 ARP 패킷임
- 브로드캐스트 메시지: 네트워크 내 모든 호스트를 대상으로 전송하는 메시지

0255

2. ARP 응답
- 호스트 B가 아닌 나머지 호스트들은 자신의 IP 주소가 아니므로 해당 메시지를 무시(폐기)함
- 호스트 B 역시 이 메시지를 받게 되는데 B는 자신의 MAC 주소를 담은 유니캐스트 메시지를 A에게 전송하게 됨
- 이 유니캐스트 메시지는 ARP 응답이라는 ARP 패킷임
	- 이 메시지를 수신한 A는 B의 MAC 주소를 알게 됨

0305

### ARP 패킷
- ARP 요청, ARP 응답 과정에서 송수신되는 패킷(패킷 = 메시지 단위)
##### 구성
- 오퍼레이션 코드(Opcode: Operation Code) - ARP 요청의 경우 1, ARP 응답의 경우 2가 명시됨
- 송신지 하드웨어 주소(Sender Hardware Address), 수신지 하드웨어 주소(Target Hardware Address): 송수신지의 MAC 주소가 명시됨 
- 송신지 프로토콜 주소(Sender Protocol Address), 수신지 프토토콜 주소(Target Protocol Address): 송수신지의 IP 주소가 명시됨

즉, 송신할 때 송신지 하드웨어 주소, 송신지 프로토콜 주소가 명시되고 수신할 때 송신지 프로토콜 주소, 수신지 프토토콜 주소가 명시됨

0420

3. ARP 테이블 갱신
- ARP 테이블(ARP Table): ARP 요청-응답을 통해 알게 된 IP주소와 MAC주소의 연관관계를 기록하는 테이블
- ARP 테이블 항목은 일정 시간이 지나면 삭제, 임의 삭제도 가능
- ARP 테이블에 등록된 호스트에 대해선 ARP 요청을 보낼 필요가 없어짐

0520

### ARP 테이블 확인
- CMD나 맥OS 터미널에서 arp -a를 입력

0640

그럼 다른 네트워크에 속한 호스트 C의 IP주소는 알지만 MAC 주소는 모르는 상황에서는 어떻게 하지??
기본적으로 ARP 요청은 해당 네트워크와 연결된 라우터들도 받게 됨


1. 같은 네트워크 내에 호스트 C가 없을 경우, ARP 요청-ARP 응답 과정을 통해 라우터 A는 자신의 MAC주소를 호스트 A에게 알려주게 됨
2. 호스트 A는 호스트 C의 MAC 주소를 알아내기 위해 라우터 A에게 ARP요청을 다시 보내게 됨

0725

3. ARP요청을 받은 라우터 A와 연결된 네트워크에도 호스트 C가 없는 경우, 위와 같은 과정으로 라우터 B에게 ARP 요청을 보내게 됨
4. 결국 호스트 C의 MAC 주소를 알게 되면 호스트 A에게 C의 MAC주소를 담아 ARP 응답을 보내게 됨

0755
